# å¤´åƒä¸Šä¼ åŠŸèƒ½æµ‹è¯•è¯´æ˜

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°
ç”¨æˆ·å¤´åƒä¸Šä¼ åŠŸèƒ½å·²å®ç°ï¼Œæ”¯æŒä¸Šä¼ ã€è·å–ã€åˆ é™¤å¤´åƒï¼Œå¹¶æ ¹æ®æ€§åˆ«è‡ªåŠ¨è®¾ç½®é»˜è®¤å¤´åƒã€‚

## ğŸ“‹ APIæ¥å£åˆ—è¡¨

### 1. ä¸Šä¼ å¤´åƒ
```
POST /api/users/{userId}/avatar/upload
Content-Type: multipart/form-data
Authorization: Bearer {token}

Body:
- file: å›¾ç‰‡æ–‡ä»¶
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "message": "å¤´åƒä¸Šä¼ æˆåŠŸ",
  "avatarUrl": "/uploads/avatars/user1_20241203143022.jpg",
  "filename": "user1_20241203143022.jpg"
}
```

### 2. è·å–å¤´åƒURL
```
GET /api/users/{userId}/avatar
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "avatarUrl": "/uploads/avatars/user1_20241203143022.jpg"
}
```

### 3. åˆ é™¤å¤´åƒï¼ˆæ¢å¤é»˜è®¤ï¼‰
```
DELETE /api/users/{userId}/avatar
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "message": "å¤´åƒå·²æ¢å¤ä¸ºé»˜è®¤å¤´åƒ",
  "avatarUrl": "/images/default-male.png"
}
```

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### 0. æµ‹è¯•æ–‡ä»¶ä¸Šä¼ é…ç½®ï¼ˆå¯é€‰ï¼‰
```bash
curl -X POST http://localhost:8080/api/users/test-upload \
  -F "file=@/path/to/your/image.jpg"
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "message": "æ–‡ä»¶ä¸Šä¼ æµ‹è¯•æˆåŠŸ",
  "filename": "test.jpg",
  "size": 12345,
  "contentType": "image/jpeg"
}
```

### 1. æ³¨å†Œç”¨æˆ·ï¼ˆå¸¦æ€§åˆ«ï¼‰
```bash
curl -X POST http://localhost:8080/api/users/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "123456",
    "nickname": "æµ‹è¯•ç”¨æˆ·",
    "email": "test@example.com",
    "gender": "MALE"
  }'
```

### 2. ç™»å½•è·å–token
```bash
curl -X POST http://localhost:8080/api/users/login \
  -H "Content-Type: application/json" \
  -d '{
    "identifier": "testuser",
    "password": "123456"
  }'
```

### 3. ä¸Šä¼ å¤´åƒ
```bash
curl -X POST http://localhost:8080/api/users/1/avatar/upload \
  -H "Authorization: Bearer {ä½ çš„token}" \
  -F "file=@/path/to/your/image.jpg"
```

### 4. è·å–å¤´åƒURL
```bash
curl -X GET http://localhost:8080/api/users/1/avatar \
  -H "Authorization: Bearer {ä½ çš„token}"
```

### 5. åˆ é™¤å¤´åƒ
```bash
curl -X DELETE http://localhost:8080/api/users/1/avatar \
  -H "Authorization: Bearer {ä½ çš„token}"
```

## ğŸ“ æ–‡ä»¶å­˜å‚¨ç»“æ„

```
src/main/resources/static/
â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ default-male.png      # ç”·æ€§é»˜è®¤å¤´åƒ
â”‚   â””â”€â”€ default-female.png    # å¥³æ€§é»˜è®¤å¤´åƒ
â””â”€â”€ uploads/
    â””â”€â”€ avatars/              # ç”¨æˆ·ä¸Šä¼ çš„å¤´åƒ
        â”œâ”€â”€ user1_20241203143022.jpg
        â””â”€â”€ user2_20241203143500.png
```

## ğŸ”§ æŠ€æœ¯å®ç°è¦ç‚¹

### 1. æ–‡ä»¶å‘½åè§„åˆ™
- æ ¼å¼ï¼š`user{ç”¨æˆ·ID}_{æ—¶é—´æˆ³}.{æ‰©å±•å}`
- ç¤ºä¾‹ï¼š`user1_20241203143022.jpg`

### 2. æƒé™æ§åˆ¶
- åªèƒ½ä¿®æ”¹è‡ªå·±çš„å¤´åƒ
- é€šè¿‡JWT tokenéªŒè¯ç”¨æˆ·èº«ä»½

### 3. é»˜è®¤å¤´åƒ
- ç”·æ€§ï¼š`/images/default-male.png`
- å¥³æ€§ï¼š`/images/default-female.png`
- æ³¨å†Œæ—¶æ ¹æ®æ€§åˆ«è‡ªåŠ¨è®¾ç½®

### 4. é™æ€èµ„æºæ˜ å°„
- ä¸Šä¼ æ–‡ä»¶ï¼š`/uploads/avatars/**`
- é»˜è®¤å¤´åƒï¼š`/images/**`

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **æ–‡ä»¶å¤§å°**ï¼šç›®å‰æ²¡æœ‰é™åˆ¶ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®æ·»åŠ 
2. **æ–‡ä»¶æ ¼å¼**ï¼šæ”¯æŒæ‰€æœ‰å›¾ç‰‡æ ¼å¼ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®é™åˆ¶
3. **å­˜å‚¨ä½ç½®**ï¼šå¼€å‘ç¯å¢ƒä½¿ç”¨æœ¬åœ°å­˜å‚¨ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨äº‘å­˜å‚¨
4. **é»˜è®¤å¤´åƒ**ï¼šéœ€è¦æ‰‹åŠ¨æ·»åŠ çœŸå®çš„PNGå›¾ç‰‡æ–‡ä»¶

## ğŸ‰ åŠŸèƒ½ç‰¹è‰²

âœ… **è‡ªåŠ¨é»˜è®¤å¤´åƒ** - æ ¹æ®æ€§åˆ«è‡ªåŠ¨è®¾ç½®  
âœ… **æƒé™éªŒè¯** - åªèƒ½ä¿®æ”¹è‡ªå·±çš„å¤´åƒ  
âœ… **æ–‡ä»¶ç®¡ç†** - è‡ªåŠ¨åˆ é™¤æ—§å¤´åƒæ–‡ä»¶  
âœ… **URLè®¿é—®** - æµè§ˆå™¨å¯ç›´æ¥è®¿é—®å¤´åƒ  
âœ… **é”™è¯¯å¤„ç†** - å®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶  

ç°åœ¨å¯ä»¥å¼€å§‹æµ‹è¯•å¤´åƒä¸Šä¼ åŠŸèƒ½äº†ï¼ ğŸš€ 